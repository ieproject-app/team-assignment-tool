<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Assignment Tool</title>
    <style>
        /* ===================
           CSS STYLES SECTION
        =================== */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Input Form Styles */
        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
            font-size: 0.95rem;
        }
        
        input[type="number"], textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        
        input[type="number"]:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .generate-btn:active {
            transform: translateY(0);
        }
        
        /* Output Section Styles */
        .output-section {
            margin-top: 30px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .copy-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .copy-btn.copied {
            background: #17a2b8;
        }
        
        /* Team Cards Grid */
        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .team-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .team-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .team-title {
            color: #667eea;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f8f9fa;
        }
        
        .team-members {
            list-style: none;
        }
        
        .team-members li {
            padding: 6px 0;
            color: #495057;
            font-size: 0.95rem;
            border-bottom: 1px solid #f8f9fa;
        }
        
        .team-members li:last-child {
            border-bottom: none;
        }
        
        .extras-card {
            border-left: 4px solid #ffc107;
        }
        
        .extras-card .team-title {
            color: #e67e22;
        }
        
        /* Text Table Styles */
        .text-table-container {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .text-table {
            width: 100%;
            font-family: 'Courier New', Monaco, monospace;
            font-size: 14px;
            white-space: pre;
            background: white;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #ced4da;
            overflow-x: auto;
            min-height: 100px;
            resize: none;
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .teams-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .section-header {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .generate-btn, .copy-btn {
                width: 100%;
                padding: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 5px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .input-section {
                padding: 20px;
            }
        }
        
        /* Hidden class for initial state */
        .hidden {
            display: none;
        }
        
        /* Loading state */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <!-- ===================
         HTML STRUCTURE
    =================== -->
    
    <div class="container">
        <h1>üèÜ Team Assignment Tool</h1>
        
        <!-- Input Form Section -->
        <div class="input-section">
            <div class="form-row">
                <div class="form-group">
                    <label for="numTeams">Number of Teams</label>
                    <input type="number" id="numTeams" value="16" min="1" max="50">
                </div>
                <div class="form-group">
                    <label for="membersPerTeam">Members per Team</label>
                    <input type="number" id="membersPerTeam" value="6" min="1" max="20">
                </div>
            </div>
            
            <div class="form-group">
                <label for="participantNames">Participant Names (one per line)</label>
                <textarea id="participantNames" placeholder="Enter participant names, one per line...&#10;Example:&#10;John Smith&#10;Jane Doe&#10;Mike Johnson&#10;Sarah Wilson"></textarea>
            </div>
            
            <button class="generate-btn" onclick="generateTeams()">Generate Teams</button>
        </div>
        
        <!-- Output Section -->
        <div id="outputSection" class="output-section hidden">
            <!-- Team Cards Display -->
            <div class="section-header">
                <h2 class="section-title">Team Assignments</h2>
            </div>
            <div id="teamsGrid" class="teams-grid"></div>
            
            <!-- Copy-Ready Text Table -->
            <div class="section-header">
                <h2 class="section-title">Copy-Ready Table</h2>
                <button class="copy-btn" onclick="copyToClipboard()">üìã Copy to Clipboard</button>
            </div>
            <div class="text-table-container">
                <textarea id="textTable" class="text-table" readonly></textarea>
            </div>
        </div>
    </div>

    <script>
        /* =====================
           JAVASCRIPT LOGIC
        ===================== */
        
        // Global variables to store current team data
        let currentTeams = [];
        let currentExtras = [];
        
        /**
         * Main function to generate teams from input data
         * This function orchestrates the entire team assignment process
         */
        function generateTeams() {
            // Get input values and validate them
            const numTeams = parseInt(document.getElementById('numTeams').value);
            const membersPerTeam = parseInt(document.getElementById('membersPerTeam').value);
            const namesInput = document.getElementById('participantNames').value.trim();
            
            // Validate inputs before processing
            if (!validateInputs(numTeams, membersPerTeam, namesInput)) {
                return;
            }
            
            // Parse names from textarea (split by newlines and clean up)
            const names = parseNames(namesInput);
            
            if (names.length === 0) {
                alert('Please enter at least one participant name.');
                return;
            }
            
            // Shuffle names for random assignment
            const shuffledNames = shuffleArray([...names]);
            
            // Assign names to teams
            const { teams, extras } = assignNamesToTeams(shuffledNames, numTeams, membersPerTeam);
            
            // Store globally for clipboard functionality
            currentTeams = teams;
            currentExtras = extras;
            
            // Display results in both formats
            displayTeamsGrid(teams, extras);
            generateTextTable(teams, extras);
            
            // Show the output section
            document.getElementById('outputSection').classList.remove('hidden');
            
            // Smooth scroll to results
            document.getElementById('outputSection').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }
        
        /**
         * Validates user inputs to ensure they're reasonable
         * @param {number} numTeams - Number of teams requested
         * @param {number} membersPerTeam - Members per team requested
         * @param {string} namesInput - Raw input string with names
         * @returns {boolean} - Whether inputs are valid
         */
        function validateInputs(numTeams, membersPerTeam, namesInput) {
            if (isNaN(numTeams) || numTeams < 1 || numTeams > 50) {
                alert('Please enter a valid number of teams (1-50).');
                return false;
            }
            
            if (isNaN(membersPerTeam) || membersPerTeam < 1 || membersPerTeam > 20) {
                alert('Please enter a valid number of members per team (1-20).');
                return false;
            }
            
            if (!namesInput) {
                alert('Please enter participant names.');
                return false;
            }
            
            return true;
        }
        
        /**
         * Parses the raw names input into a clean array
         * Handles various line endings and removes empty lines
         * @param {string} namesInput - Raw input string
         * @returns {Array} - Clean array of names
         */
        function parseNames(namesInput) {
            return namesInput
                .split(/\r?\n/)  // Split on any type of line break
                .map(name => name.trim())  // Remove whitespace
                .filter(name => name.length > 0)  // Remove empty lines
                .filter((name, index, array) => array.indexOf(name) === index);  // Remove duplicates
        }
        
        /**
         * Shuffles an array using the Fisher-Yates algorithm
         * This ensures truly random team assignments
         * @param {Array} array - Array to shuffle
         * @returns {Array} - Shuffled array
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        /**
         * Assigns shuffled names to teams based on specified parameters
         * @param {Array} names - Shuffled array of participant names
         * @param {number} numTeams - Number of teams to create
         * @param {number} membersPerTeam - Target members per team
         * @returns {Object} - Object containing teams array and extras array
         */
        function assignNamesToTeams(names, numTeams, membersPerTeam) {
            const teams = [];
            const totalSlotsNeeded = numTeams * membersPerTeam;
            
            // Initialize empty teams
            for (let i = 0; i < numTeams; i++) {
                teams.push({
                    number: i + 1,
                    members: []
                });
            }
            
            // Assign names to teams sequentially after shuffling
            let nameIndex = 0;
            for (let teamIndex = 0; teamIndex < numTeams && nameIndex < names.length; teamIndex++) {
                for (let memberSlot = 0; memberSlot < membersPerTeam && nameIndex < names.length; memberSlot++) {
                    teams[teamIndex].members.push(names[nameIndex]);
                    nameIndex++;
                }
            }
            
            // Handle extras (remaining names that don't fit in regular teams)
            const extras = names.slice(nameIndex);
            
            return { teams, extras };
        }
        
        /**
         * Creates and displays the visual team cards grid
         * @param {Array} teams - Array of team objects
         * @param {Array} extras - Array of extra participant names
         */
        function displayTeamsGrid(teams, extras) {
            const container = document.getElementById('teamsGrid');
            container.innerHTML = '';
            
            // Create cards for regular teams
            teams.forEach(team => {
                if (team.members.length > 0) {  // Only show teams with members
                    const card = createTeamCard(team);
                    container.appendChild(card);
                }
            });
            
            // Create extras card if there are leftover participants
            if (extras.length > 0) {
                const extrasCard = createExtrasCard(extras);
                container.appendChild(extrasCard);
            }
        }
        
        /**
         * Creates a single team card element
         * @param {Object} team - Team object with number and members
         * @returns {HTMLElement} - DOM element for the team card
         */
        function createTeamCard(team) {
            const card = document.createElement('div');
            card.className = 'team-card';
            
            const title = document.createElement('h3');
            title.className = 'team-title';
            title.textContent = `Team ${team.number}`;
            
            const membersList = document.createElement('ul');
            membersList.className = 'team-members';
            
            team.members.forEach(member => {
                const listItem = document.createElement('li');
                listItem.textContent = member;
                membersList.appendChild(listItem);
            });
            
            card.appendChild(title);
            card.appendChild(membersList);
            
            return card;
        }
        
        /**
         * Creates the extras card for leftover participants
         * @param {Array} extras - Array of extra participant names
         * @returns {HTMLElement} - DOM element for the extras card
         */
        function createExtrasCard(extras) {
            const card = document.createElement('div');
            card.className = 'team-card extras-card';
            
            const title = document.createElement('h3');
            title.className = 'team-title';
            title.textContent = 'Extras';
            
            const membersList = document.createElement('ul');
            membersList.className = 'team-members';
            
            extras.forEach(member => {
                const listItem = document.createElement('li');
                listItem.textContent = member;
                membersList.appendChild(listItem);
            });
            
            card.appendChild(title);
            card.appendChild(membersList);
            
            return card;
        }
        
        /**
         * Generates the plain-text table format for easy copying to Excel
         * Uses tab separation for optimal Excel compatibility
         * @param {Array} teams - Array of team objects
         * @param {Array} extras - Array of extra participant names
         */
        function generateTextTable(teams, extras) {
            let tableText = 'Team\tMember\n';  // Header row with tab separator
            tableText += '----\t------\n';     // Separator row
            
            // Add regular team members
            teams.forEach(team => {
                if (team.members.length > 0) {
                    team.members.forEach(member => {
                        tableText += `Team ${team.number}\t${member}\n`;
                    });
                }
            });
            
            // Add extras if they exist
            if (extras.length > 0) {
                extras.forEach(member => {
                    tableText += `Extras\t${member}\n`;
                });
            }
            
            // Display in the textarea
            document.getElementById('textTable').value = tableText;
        }
        
        /**
         * Copies the text table to clipboard with user feedback
         * Uses the modern Clipboard API with fallback for older browsers
         */
        async function copyToClipboard() {
            const textTable = document.getElementById('textTable');
            const copyBtn = document.querySelector('.copy-btn');
            
            try {
                // Use modern Clipboard API if available
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText(textTable.value);
                } else {
                    // Fallback for older browsers
                    textTable.select();
                    textTable.setSelectionRange(0, 99999); // For mobile devices
                    document.execCommand('copy');
                }
                
                // Provide user feedback
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '‚úÖ Copied!';
                copyBtn.classList.add('copied');
                
                // Reset button after 2 seconds
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.classList.remove('copied');
                }, 2000);
                
            } catch (err) {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy to clipboard. Please select the text manually and copy it.');
            }
        }
        
        // Allow Enter key to trigger team generation when in number inputs
        document.getElementById('numTeams').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateTeams();
            }
        });
        
        document.getElementById('membersPerTeam').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateTeams();
            }
        });
        
        // Auto-resize textarea based on content
        document.getElementById('participantNames').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.max(120, this.scrollHeight) + 'px';
        });
    </script>
</body>
</html>
