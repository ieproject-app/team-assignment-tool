<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Randomizer</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #2d3748;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        /* Input Form Styles */
        .input-section {
            background: #f8fafc;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .form-group input, 
        .form-group textarea {
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .form-group input:focus, 
        .form-group textarea:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
            font-family: 'Courier New', monospace;
        }

        .generate-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            margin-top: 16px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.3);
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(16, 185, 129, 0.4);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        /* Results Section */
        .results-section {
            display: none;
            margin-top: 40px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border-radius: 2px;
        }

        /* Team Cards Grid */
        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .team-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }

        .team-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
        }

        .team-header {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            padding: 12px 16px;
            border-radius: 10px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 16px;
        }

        .team-members {
            list-style: none;
        }

        .team-members li {
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
            color: #374151;
        }

        .team-members li:last-child {
            border-bottom: none;
        }

        .team-members li::before {
            content: 'ðŸ‘¤';
            margin-right: 8px;
        }

        /* Text Table Section */
        .text-output {
            background: #f8fafc;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .copy-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .copy-btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .copy-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .copy-success {
            background: linear-gradient(135deg, #10b981, #059669) !important;
        }

        .text-table {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            white-space: pre-line;
            color: #374151;
            max-height: 300px;
            overflow-y: auto;
        }

        /* Excel Instructions */
        .excel-instructions {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .excel-instructions h3 {
            color: #92400e;
            font-size: 1.1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .excel-instructions h3::before {
            content: 'ðŸ“Š';
        }

        .excel-instructions ol {
            color: #78350f;
            padding-left: 20px;
        }

        .excel-instructions li {
            margin-bottom: 6px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 16px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .content {
                padding: 20px;
            }

            .input-section {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .teams-grid {
                grid-template-columns: 1fr;
            }

            .copy-section {
                flex-direction: column;
                align-items: stretch;
            }

            .copy-btn {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 1.75rem;
            }

            .section-title {
                font-size: 1.25rem;
            }
        }

        /* Loading State */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .loading .generate-btn {
            background: #9ca3af;
        }

        /* Animation for results appearing */
        .results-section.show {
            display: block;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Team Randomizer</h1>
            <p>Automatically distribute participants into balanced teams with Excel export support</p>
        </div>

        <div class="content">
            <!-- Input Form Section -->
            <div class="input-section">
                <div class="form-row">
                    <div class="form-group">
                        <label for="numTeams">Number of Teams</label>
                        <input type="number" id="numTeams" min="1" max="50" value="3" />
                    </div>
                    <div class="form-group">
                        <label for="membersPerTeam">Members per Team</label>
                        <input type="number" id="membersPerTeam" min="1" max="20" value="6" />
                    </div>
                </div>
                <div class="form-group">
                    <label for="participantNames">Participant Names (one per line)</label>
                    <textarea 
                        id="participantNames" 
                        placeholder="Enter participant names, one per line...&#10;Example:&#10;Alice Johnson&#10;Bob Smith&#10;Carol Williams&#10;David Brown"
                        rows="8"
                    ></textarea>
                </div>
                <button class="generate-btn" onclick="generateTeams()">
                    ðŸŽ² Generate Teams
                </button>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <!-- Team Cards Display -->
                <div class="section-title">Team Distribution</div>
                <div class="teams-grid" id="teamsGrid"></div>

                <!-- Text Table Output -->
                <div class="text-output">
                    <div class="copy-section">
                        <div class="section-title">Excel-Ready Format</div>
                        <button class="copy-btn" id="copyBtn" onclick="copyToClipboard()">
                            ðŸ“‹ Copy to Clipboard
                        </button>
                    </div>
                    <div class="text-table" id="textTable"></div>
                    
                    <!-- Excel Instructions -->
                    <div class="excel-instructions">
                        <h3>Cara Salin ke Excel:</h3>
                        <ol>
                            <li>Klik tombol "Copy to Clipboard" di atas</li>
                            <li>Buka Excel dan paste langsung (Ctrl+V)</li>
                            <li>Gunakan menu <em>Data > Text to Columns > Delimited > Tab</em> untuk memisahkan kolom secara otomatis</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables to store current results
        let currentTeams = [];
        let currentTextOutput = '';

        /**
         * Main function to generate teams from input data
         * Uses round-robin distribution to ensure balanced teams
         */
        function generateTeams() {
            // Get input values
            const numTeamsInput = parseInt(document.getElementById('numTeams').value);
            const membersPerTeam = parseInt(document.getElementById('membersPerTeam').value);
            const participantText = document.getElementById('participantNames').value.trim();

            // Validate inputs
            if (!participantText) {
                alert('Please enter participant names!');
                return;
            }

            if (numTeamsInput < 1 || membersPerTeam < 1) {
                alert('Please enter valid numbers for teams and members!');
                return;
            }

            // Parse participant names (filter out empty lines)
            const participants = participantText
                .split('\n')
                .map(name => name.trim())
                .filter(name => name.length > 0);

            if (participants.length === 0) {
                alert('No valid participant names found!');
                return;
            }

            // Shuffle participants for random distribution
            const shuffledParticipants = shuffleArray([...participants]);

            // Calculate required number of teams
            // If we have more participants than initial configuration allows, create additional teams
            const maxParticipantsInInitialTeams = numTeamsInput * membersPerTeam;
            const totalTeamsNeeded = Math.ceil(shuffledParticipants.length / membersPerTeam);
            const finalTeamCount = Math.max(numTeamsInput, totalTeamsNeeded);

            // Initialize teams array
            currentTeams = [];
            for (let i = 0; i < finalTeamCount; i++) {
                currentTeams.push({
                    name: `Team ${i + 1}`,
                    members: []
                });
            }

            // Distribute participants using round-robin method
            // This ensures even distribution across all teams
            shuffledParticipants.forEach((participant, index) => {
                const teamIndex = index % finalTeamCount;
                currentTeams[teamIndex].members.push(participant);
            });

            // Display results
            displayTeamCards();
            generateTextOutput();
            showResults();
        }

        /**
         * Fisher-Yates shuffle algorithm for random array shuffling
         * @param {Array} array - Array to shuffle
         * @returns {Array} - Shuffled array
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Display teams in card format using CSS Grid
         */
        function displayTeamCards() {
            const teamsGrid = document.getElementById('teamsGrid');
            teamsGrid.innerHTML = '';

            currentTeams.forEach(team => {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                
                const teamHeader = document.createElement('div');
                teamHeader.className = 'team-header';
                teamHeader.textContent = team.name;
                
                const membersList = document.createElement('ul');
                membersList.className = 'team-members';
                
                team.members.forEach(member => {
                    const memberItem = document.createElement('li');
                    memberItem.textContent = member;
                    membersList.appendChild(memberItem);
                });
                
                teamCard.appendChild(teamHeader);
                teamCard.appendChild(membersList);
                teamsGrid.appendChild(teamCard);
            });
        }

        /**
         * Generate tab-separated text output for Excel compatibility
         */
        function generateTextOutput() {
            let output = '';
            
            // Add header row
            output += 'Team Name\tMember Name\n';
            
            // Add team data with tab separation
            currentTeams.forEach(team => {
                team.members.forEach(member => {
                    output += `${team.name}\t${member}\n`;
                });
            });
            
            currentTextOutput = output;
            document.getElementById('textTable').textContent = currentTextOutput;
        }

        /**
         * Show the results section with animation
         */
        function showResults() {
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.classList.add('show');
            
            // Scroll to results section smoothly
            resultsSection.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'start' 
            });
        }

        /**
         * Copy text output to clipboard with user feedback
         */
        async function copyToClipboard() {
            const copyBtn = document.getElementById('copyBtn');
            const originalText = copyBtn.innerHTML;
            
            try {
                // Use modern clipboard API if available
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText(currentTextOutput);
                } else {
                    // Fallback for older browsers
                    const textArea = document.createElement('textarea');
                    textArea.value = currentTextOutput;
                    textArea.style.position = 'fixed';
                    textArea.style.left = '-999999px';
                    textArea.style.top = '-999999px';
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    document.execCommand('copy');
                    textArea.remove();
                }
                
                // Show success feedback
                copyBtn.innerHTML = 'âœ… Copied!';
                copyBtn.classList.add('copy-success');
                
                // Reset button after 2 seconds
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.classList.remove('copy-success');
                }, 2000);
                
            } catch (err) {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy to clipboard. Please select and copy the text manually.');
            }
        }

        /**
         * Initialize the application when DOM is loaded
         */
        document.addEventListener('DOMContentLoaded', function() {
            // Add sample data for demonstration
            const sampleNames = [
                'Alice Johnson',
                'Bob Smith', 
                'Carol Williams',
                'David Brown',
                'Emma Davis',
                'Frank Miller',
                'Grace Wilson',
                'Henry Moore',
                'Ivy Taylor',
                'Jack Anderson',
                'Kelly Thomas',
                'Liam Jackson',
                'Maya White',
                'Noah Harris',
                'Olivia Martin',
                'Paul Thompson',
                'Quinn Garcia',
                'Ruby Martinez'
            ].join('\n');
            
            document.getElementById('participantNames').value = sampleNames;
            
            // Add Enter key support for generate button
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Enter' && event.ctrlKey) {
                    generateTeams();
                }
            });
        });

        // Add input validation for number fields
        document.getElementById('numTeams').addEventListener('input', function() {
            const value = parseInt(this.value);
            if (value < 1) this.value = 1;
            if (value > 50) this.value = 50;
        });

        document.getElementById('membersPerTeam').addEventListener('input', function() {
            const value = parseInt(this.value);
            if (value < 1) this.value = 1;
            if (value > 20) this.value = 20;
        });
    </script>
</body>
</html>
